<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>tufao: Tufao::HttpUpgradeRouter Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="tufao_logo.svg"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">tufao
   &#160;<span id="projectnumber">1.3.0</span>
   </div>
   <div id="projectbrief">An asynchronous web framework for C++ built on top of Qt</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('class_tufao_1_1_http_upgrade_router.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-slots">Public Slots</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_tufao_1_1_http_upgrade_router-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Tufao::HttpUpgradeRouter Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class provides a robust and high performance HTTP request router.  
 <a href="class_tufao_1_1_http_upgrade_router.html#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for Tufao::HttpUpgradeRouter:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_tufao_1_1_http_upgrade_router__inherit__graph.png" border="0" usemap="#_tufao_1_1_http_upgrade_router_inherit__map" alt="Inheritance graph"/></div>
<map name="_tufao_1_1_http_upgrade_router_inherit__map" id="_tufao_1_1_http_upgrade_router_inherit__map">
<area shape="rect" id="node3" href="class_tufao_1_1_abstract_http_upgrade_handler.html" title="This class provides an interface for HTTP Upgrade handlers. " alt="" coords="100,5,315,171"/></map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for Tufao::HttpUpgradeRouter:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_tufao_1_1_http_upgrade_router__coll__graph.png" border="0" usemap="#_tufao_1_1_http_upgrade_router_coll__map" alt="Collaboration graph"/></div>
<map name="_tufao_1_1_http_upgrade_router_coll__map" id="_tufao_1_1_http_upgrade_router_coll__map">
<area shape="rect" id="node3" href="class_tufao_1_1_abstract_http_upgrade_handler.html" title="This class provides an interface for HTTP Upgrade handlers. " alt="" coords="100,5,315,171"/></map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_tufao_1_1_http_upgrade_router_1_1_mapping.html">Mapping</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class describes a request handler and a filter.  <a href="struct_tufao_1_1_http_upgrade_router_1_1_mapping.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a34cd4c64fa3ca500e7a51126f2cdb5c3"><td class="memItemLeft" align="right" valign="top">typedef std::function&lt; bool(<a class="el" href="class_tufao_1_1_http_server_request.html">HttpServerRequest</a> &amp;, const QByteArray &amp;head)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_http_upgrade_router.html#a34cd4c64fa3ca500e7a51126f2cdb5c3">Handler</a></td></tr>
<tr class="memdesc:a34cd4c64fa3ca500e7a51126f2cdb5c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">It's a simple typedef for the type of handler accepted by the <a class="el" href="class_tufao_1_1_http_upgrade_router.html" title="This class provides a robust and high performance HTTP request router. ">HttpUpgradeRouter</a>.  <a href="#a34cd4c64fa3ca500e7a51126f2cdb5c3">More...</a><br /></td></tr>
<tr class="separator:a34cd4c64fa3ca500e7a51126f2cdb5c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-slots"></a>
Public Slots</h2></td></tr>
<tr class="memitem:ac809f83d594f8f9ff1b6896ff02451d8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_http_upgrade_router.html#ac809f83d594f8f9ff1b6896ff02451d8">handleUpgrade</a> (<a class="el" href="class_tufao_1_1_http_server_request.html">Tufao::HttpServerRequest</a> &amp;request, const QByteArray &amp;head) override</td></tr>
<tr class="memdesc:ac809f83d594f8f9ff1b6896ff02451d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">It will route the request to the right handler.  <a href="#ac809f83d594f8f9ff1b6896ff02451d8">More...</a><br /></td></tr>
<tr class="separator:ac809f83d594f8f9ff1b6896ff02451d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa6bb51d7438b07778873338f4943b6fa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa6bb51d7438b07778873338f4943b6fa"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_http_upgrade_router.html#aa6bb51d7438b07778873338f4943b6fa">HttpUpgradeRouter</a> (QObject *parent=0)</td></tr>
<tr class="memdesc:aa6bb51d7438b07778873338f4943b6fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="class_tufao_1_1_http_server_request_router.html" title="This class provides a robust and high performance HTTP request router. ">HttpServerRequestRouter</a> object. <br /></td></tr>
<tr class="separator:aa6bb51d7438b07778873338f4943b6fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4141c12a85a19a98d77e278da8fe2f6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af4141c12a85a19a98d77e278da8fe2f6"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_http_upgrade_router.html#af4141c12a85a19a98d77e278da8fe2f6">HttpUpgradeRouter</a> (std::initializer_list&lt; <a class="el" href="struct_tufao_1_1_http_upgrade_router_1_1_mapping.html">Mapping</a> &gt; mappings, QObject *parent=0)</td></tr>
<tr class="memdesc:af4141c12a85a19a98d77e278da8fe2f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="class_tufao_1_1_http_server_request_router.html" title="This class provides a robust and high performance HTTP request router. ">HttpServerRequestRouter</a> object initialized with <code>mappings</code>. <br /></td></tr>
<tr class="separator:af4141c12a85a19a98d77e278da8fe2f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b3b5edc42f9d0691e9e162060062007"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b3b5edc42f9d0691e9e162060062007"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_http_upgrade_router.html#a0b3b5edc42f9d0691e9e162060062007">~HttpUpgradeRouter</a> ()</td></tr>
<tr class="memdesc:a0b3b5edc42f9d0691e9e162060062007"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the object. <br /></td></tr>
<tr class="separator:a0b3b5edc42f9d0691e9e162060062007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1211045da52a531e792bd6e4d2fa9859"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_http_upgrade_router.html#a1211045da52a531e792bd6e4d2fa9859">map</a> (<a class="el" href="struct_tufao_1_1_http_upgrade_router_1_1_mapping.html">Mapping</a> map)</td></tr>
<tr class="memdesc:a1211045da52a531e792bd6e4d2fa9859"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chain <code>map</code> to the list of handlers available to handle requests.  <a href="#a1211045da52a531e792bd6e4d2fa9859">More...</a><br /></td></tr>
<tr class="separator:a1211045da52a531e792bd6e4d2fa9859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee83874d12ef31d0fd4407f1bde1b40"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_http_upgrade_router.html#aeee83874d12ef31d0fd4407f1bde1b40">map</a> (std::initializer_list&lt; <a class="el" href="struct_tufao_1_1_http_upgrade_router_1_1_mapping.html">Mapping</a> &gt; map)</td></tr>
<tr class="memdesc:aeee83874d12ef31d0fd4407f1bde1b40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Chain <code>map</code> to the list of handlers available to handle requests.  <a href="#aeee83874d12ef31d0fd4407f1bde1b40">More...</a><br /></td></tr>
<tr class="separator:aeee83874d12ef31d0fd4407f1bde1b40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1618ac7bba3d6c3a22eb32c97fc6239c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1618ac7bba3d6c3a22eb32c97fc6239c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_http_upgrade_router.html#a1618ac7bba3d6c3a22eb32c97fc6239c">unmap</a> (int index)</td></tr>
<tr class="memdesc:a1618ac7bba3d6c3a22eb32c97fc6239c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the mapping at <code>index</code>. <br /></td></tr>
<tr class="separator:a1618ac7bba3d6c3a22eb32c97fc6239c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9aacbe250826c1df1ce6edd3e14bb833"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9aacbe250826c1df1ce6edd3e14bb833"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_http_upgrade_router.html#a9aacbe250826c1df1ce6edd3e14bb833">clear</a> ()</td></tr>
<tr class="memdesc:a9aacbe250826c1df1ce6edd3e14bb833"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes all mappings. <br /></td></tr>
<tr class="separator:a9aacbe250826c1df1ce6edd3e14bb833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_tufao_1_1_abstract_http_upgrade_handler"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_tufao_1_1_abstract_http_upgrade_handler')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_tufao_1_1_abstract_http_upgrade_handler.html">Tufao::AbstractHttpUpgradeHandler</a></td></tr>
<tr class="memitem:a88f0febbe7bfb88cf1c2d7b7fd275b36 inherit pub_methods_class_tufao_1_1_abstract_http_upgrade_handler"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_abstract_http_upgrade_handler.html#a88f0febbe7bfb88cf1c2d7b7fd275b36">operator std::function&lt; bool</a> (<a class="el" href="class_tufao_1_1_http_server_request.html">HttpServerRequest</a> &amp;, const QByteArray &amp;)&gt;()</td></tr>
<tr class="memdesc:a88f0febbe7bfb88cf1c2d7b7fd275b36 inherit pub_methods_class_tufao_1_1_abstract_http_upgrade_handler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implicit conversion operator to std::function functor object.  <a href="#a88f0febbe7bfb88cf1c2d7b7fd275b36">More...</a><br /></td></tr>
<tr class="separator:a88f0febbe7bfb88cf1c2d7b7fd275b36 inherit pub_methods_class_tufao_1_1_abstract_http_upgrade_handler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3043446ed422b426d86061f20585b924 inherit pub_methods_class_tufao_1_1_abstract_http_upgrade_handler"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_abstract_http_upgrade_handler.html#a3043446ed422b426d86061f20585b924">operator std::function&lt; void</a> (<a class="el" href="class_tufao_1_1_http_server_request.html">HttpServerRequest</a> &amp;, const QByteArray &amp;)&gt;()</td></tr>
<tr class="memdesc:a3043446ed422b426d86061f20585b924 inherit pub_methods_class_tufao_1_1_abstract_http_upgrade_handler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implicit conversion operator to std::function functor object.  <a href="#a3043446ed422b426d86061f20585b924">More...</a><br /></td></tr>
<tr class="separator:a3043446ed422b426d86061f20585b924 inherit pub_methods_class_tufao_1_1_abstract_http_upgrade_handler"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f4475d02abe5e9094e82991a329955c inherit pub_methods_class_tufao_1_1_abstract_http_upgrade_handler"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tufao_1_1_abstract_http_upgrade_handler.html#a7f4475d02abe5e9094e82991a329955c">handleUpgrade</a> (<a class="el" href="class_tufao_1_1_http_server_request.html">Tufao::HttpServerRequest</a> &amp;request, const QByteArray &amp;head)=0</td></tr>
<tr class="memdesc:a7f4475d02abe5e9094e82991a329955c inherit pub_methods_class_tufao_1_1_abstract_http_upgrade_handler"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the HTTP <code>request</code>.  <a href="#a7f4475d02abe5e9094e82991a329955c">More...</a><br /></td></tr>
<tr class="separator:a7f4475d02abe5e9094e82991a329955c inherit pub_methods_class_tufao_1_1_abstract_http_upgrade_handler"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class provides a robust and high performance HTTP request router. </p>
<p>It allows to register a chain of upgrade handlers. This router uses mapping rules based on the url's path component to determine the correct handlers.</p>
<p>The type of mapping rules used in this class provides a predictable behaviour that is simple to understand and allow the use of caching algorithms to improve the performance.</p>
<p>When the router finds one matching request handler, it will call it. If the found handler cannot handle the request (this is indicated by the return value), the router will continue its quest in the search of a worthy handler. If the router fails in its quest (when no handlers are found or when none of the found handlers are able to respond the request), the handleRequest method in the router returns false and the connection remains open.</p>
<p>The code below provides an example usage:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using namespace </span><a class="code" href="namespace_tufao.html">Tufao</a>;</div>
<div class="line"></div>
<div class="line">    QCoreApplication a(argc, argv);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="class_tufao_1_1_http_upgrade_router.html">HttpUpgradeRouter</a> upgradeRouter{</div>
<div class="line">        {QRegularExpression{<span class="stringliteral">&quot;^/chat$&quot;</span>}, [](HttpServerRequest &amp;request,</div>
<div class="line">                                           <span class="keyword">const</span> QByteArray &amp;head) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line">                <a class="code" href="class_tufao_1_1_web_socket.html">WebSocket</a> *ws = <span class="keyword">new</span> <a class="code" href="class_tufao_1_1_web_socket.html">WebSocket</a>;</div>
<div class="line"></div>
<div class="line">                ws-&gt;<a class="code" href="class_tufao_1_1_web_socket.html#a1b510d57a12d2b04adb568823a30baef">startServerHandshake</a>(request, head);</div>
<div class="line"></div>
<div class="line">                <span class="comment">// ...</span></div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <a class="code" href="class_tufao_1_1_http_server.html">HttpServer</a> server;</div>
<div class="line">    server.<a class="code" href="class_tufao_1_1_http_server.html#af922c979376464c6f5b5d31a3746b64c">setUpgradeHandler</a>(upgradeRouter);</div>
<div class="line"></div>
<div class="line">    QObject::connect(&amp;server, &amp;<a class="code" href="class_tufao_1_1_http_server.html#a3b35a246b8d6ca72cc246a36c1e4ae71">HttpServer::requestReady</a>,</div>
<div class="line">                     &amp;router, &amp;<a class="code" href="class_tufao_1_1_http_server_request_router.html#a4b2f5dcb77545084f99a28880e6fc5ae">HttpServerRequestRouter::handleRequest</a>);</div>
<div class="line"></div>
<div class="line">    server.<a class="code" href="class_tufao_1_1_http_server.html#a53ebaa69281886b1b8c2b535aaec8cd9">listen</a>(QHostAddress::Any, 8080);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> a.exec();</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="class_tufao_1_1_http_server.html#af922c979376464c6f5b5d31a3746b64c" title="This method sets the handler that will be called to handle http upgrade requests. ...">HttpServer::setUpgradeHandler</a></dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a34cd4c64fa3ca500e7a51126f2cdb5c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::function&lt;bool(<a class="el" href="class_tufao_1_1_http_server_request.html">HttpServerRequest</a>&amp;, const QByteArray &amp;head)&gt; <a class="el" href="class_tufao_1_1_http_upgrade_router.html#a34cd4c64fa3ca500e7a51126f2cdb5c3">Tufao::HttpUpgradeRouter::Handler</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It's a simple typedef for the type of handler accepted by the <a class="el" href="class_tufao_1_1_http_upgrade_router.html" title="This class provides a robust and high performance HTTP request router. ">HttpUpgradeRouter</a>. </p>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac809f83d594f8f9ff1b6896ff02451d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool Tufao::HttpUpgradeRouter::handleUpgrade </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_tufao_1_1_http_server_request.html">Tufao::HttpServerRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QByteArray &amp;&#160;</td>
          <td class="paramname"><em>head</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>It will route the request to the right handler. </p>
<p>The handler will have access to the list of captured texts by the regular expression using <a class="el" href="class_tufao_1_1_http_server_request.html#ab3c0be63479f7414073f5bb37a2a9297" title="Returns the user data as set in setCustomData. ">HttpServerRequest::customData</a>.</p>
<dl class="section note"><dt>Note</dt><dd>The router won't touch the <a class="el" href="class_tufao_1_1_http_server_request.html#ab3c0be63479f7414073f5bb37a2a9297" title="Returns the user data as set in setCustomData. ">HttpServerRequest::customData</a> if the regex don't capture any text.</dd></dl>
<p>See example below:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> Handler::handleRequest(HttpServerRequest &amp;request,</div>
<div class="line">                            HttpServerResponse &amp;response)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line"></div>
<div class="line">    QStringList args = request.customData().toMap()[<span class="stringliteral">&quot;args&quot;</span>].toStringList();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>If there is already an object set for this request, the router will do the following steps:</p>
<ol type="1">
<li>If the object is not a QVariantMap, override it</li>
<li>If the object already has a item with the key "args", but the value is not a QStringList, override the item</li>
<li>Append the list of captured texts in the object["args"]</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>The request's custom data is copied at the beginning and is used to restore the custom data state before call every handler. The state will also be restored if no handlers are capable of handle the request.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if one handler able to respond the request is found.</dd></dl>
<dl class="section since"><dt>Since</dt><dd>1.0 </dd></dl>

</div>
</div>
<a class="anchor" id="a1211045da52a531e792bd6e4d2fa9859"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Tufao::HttpUpgradeRouter::map </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_tufao_1_1_http_upgrade_router_1_1_mapping.html">Mapping</a>&#160;</td>
          <td class="paramname"><em>map</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chain <code>map</code> to the list of handlers available to handle requests. </p>
<dl class="section return"><dt>Returns</dt><dd>The index of the new mapping. </dd></dl>

</div>
</div>
<a class="anchor" id="aeee83874d12ef31d0fd4407f1bde1b40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Tufao::HttpUpgradeRouter::map </td>
          <td>(</td>
          <td class="paramtype">std::initializer_list&lt; <a class="el" href="struct_tufao_1_1_http_upgrade_router_1_1_mapping.html">Mapping</a> &gt;&#160;</td>
          <td class="paramname"><em>map</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Chain <code>map</code> to the list of handlers available to handle requests. </p>
<dl class="section return"><dt>Returns</dt><dd>The index of the first element in the new mapping range. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="httpupgraderouter_8h_source.html">httpupgraderouter.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_tufao.html">Tufao</a></li><li class="navelem"><a class="el" href="class_tufao_1_1_http_upgrade_router.html">HttpUpgradeRouter</a></li>
    <li class="footer">Generated on Sun Mar 29 2015 12:14:31 for tufao by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
